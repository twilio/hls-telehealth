(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[515],{6281:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/patient/waiting-room",function(){return n(8112)}])},2154:function(e,t,n){"use strict";n.d(t,{c:function(){return c}});var i=n(5893),r=n(7294);function o(e){var t,n,o=e.track,a=e.isLocal,s=e.priority,c=(0,r.useRef)(null),l=function(e){var t=(0,r.useState)(null===e||void 0===e?void 0:e.mediaStreamTrack),n=t[0],i=t[1];return(0,r.useEffect)((function(){if(i(null===e||void 0===e?void 0:e.mediaStreamTrack),e){var t=function(){return i(e.mediaStreamTrack)};return e.on("started",t),function(){e.off("started",t)}}}),[e]),n}(o),u=function(e){var t=(0,r.useState)(null===e||void 0===e?void 0:e.dimensions),n=t[0],i=t[1];return(0,r.useEffect)((function(){if(i(null===e||void 0===e?void 0:e.dimensions),e){var t=function(e){return i({width:e.dimensions.width,height:e.dimensions.height})};return e.on("dimensionsChanged",t),function(){e.off("dimensionsChanged",t)}}}),[e]),n}(o),d=(null!==(t=null===u||void 0===u?void 0:u.height)&&void 0!==t?t:0)>(null!==(n=null===u||void 0===u?void 0:u.width)&&void 0!==n?n:0);(0,r.useEffect)((function(){var e=c.current;return e.muted=!0,o.setPriority&&s&&o.setPriority(s),o.attach(e),function(){o.detach(e),e.srcObject=null,o.setPriority&&s&&o.setPriority(null)}}),[o,s]);var m="environment"!==(null===l||void 0===l?void 0:l.getSettings().facingMode),f={transform:a&&m?"rotateY(180deg)":"",objectFit:d||o.name.includes("screen")?"contain":"cover"};return(0,i.jsx)("video",{ref:c,style:f})}var a=n(5428),s=n(6419),c=function(e){var t=e.videoImage,n=(0,a.Z)().localTracks.find((function(e){return e.name.includes("camera")}));return(0,i.jsxs)("div",{className:"flex mt-4 mb-1",children:[(0,i.jsxs)("div",{className:"flex flex-col justify-center px-1",children:[(0,i.jsx)(s.z,{className:"my-2",icon:"flip_camera_ios",iconType:"outline",variant:s.W.tertiary}),(0,i.jsx)(s.z,{className:"my-2",icon:"videocam",iconType:"outline",variant:s.W.tertiary}),(0,i.jsx)(s.z,{className:"my-2",icon:"mic",iconType:"outline",variant:s.W.tertiary})]}),(0,i.jsx)("div",{className:"flex-grow px-1",children:n?(0,i.jsx)(o,{track:n,isLocal:!0}):(0,i.jsx)("img",{src:t,alt:"Video",width:187,height:250})})]})}},8112:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return g}});var i=n(5893),r=n(7294),o=n(6419),a=n(9716),s=function(e){var t=e.name;return(0,i.jsx)(a.J,{className:"mr-2 text-tertiary",name:t})},c=function(e){var t=e.date;return(0,i.jsxs)("div",{className:"flex border border-light rounded-lg text-secondary",children:[(0,i.jsxs)("div",{className:"flex flex-grow p-2 border-r border-light",children:[(0,i.jsx)(s,{name:"calendar_today"})," ",t.toLocaleString("default",{month:"short",day:"numeric",year:"numeric"})]}),(0,i.jsxs)("div",{className:"flex flex-grow p-2",children:[(0,i.jsx)(s,{name:"schedule"})," ",t.toLocaleString("default",{hour:"numeric",minute:"numeric",hour12:!0})]})]})},l=n(9783),u=n(1117),d=n(9891),m=n(2154),f=n(1582),v=n(5428),h=n(4291),x=n(602),j=n(1163),p=function(){var e=(0,r.useState)(!1),t=e[0],n=e[1],a=(0,f.R)(),s=a.visit,h=a.user,p=(0,v.Z)().getAudioAndVideoTracks,g=(0,r.useState)(),y=g[0],N=g[1],k=(0,j.useRouter)();return(0,r.useEffect)((function(){y||p().catch((function(e){console.log("Error acquiring local media:"),console.dir(e),N(e)}))}),[p,y]),(0,r.useEffect)((function(){if(console.log("visit: ",s),console.log("user: ",h),h&&s){var e=setInterval((function(){return x.G.checkRoom(h,s.roomName).then((function(e){e.roomAvailable&&k.push("/patient/video/")}))}),5e3);return function(){return clearInterval(e)}}}),[k,s,h]),(0,i.jsxs)(u.Ar,{children:[s?(0,i.jsxs)("div",{className:"my-4 flex flex-col items-center justify-center",children:[(0,i.jsx)(l.X,{children:"Your Appointment"}),(0,i.jsx)("div",{className:"mb-2 text-secondary",children:s.providerName}),(0,i.jsx)(c,{date:s.visitDateTime}),(0,i.jsx)(m.c,{videoImage:"/patient.jpg"}),(0,i.jsx)("div",{className:"text-tertiary",children:"Your visit will start when the provider joins"}),(0,i.jsx)("div",{className:"flex items-center justify-center bg-secondary text-white text-2xl h-[200px] w-full m-2",children:"Content Area"}),(0,i.jsx)(o.z,{className:"mt-2 px-8",variant:o.W.secondary,outline:!0,onClick:function(){return n(!0)},children:"Leave Waiting Room"})]}):(0,i.jsx)(i.Fragment,{}),(0,i.jsx)(d.u,{isVisible:t,children:(0,i.jsxs)("div",{className:"flex flex-col text-center p-4",children:[(0,i.jsx)("p",{className:"mb-4 text-primary",children:"Are you sure you want to leave the waiting room? Your visit will start shortly."}),(0,i.jsx)(o.z,{className:"mt-2 px-8",onClick:function(){return n(!1)},children:"Stay in Waiting Room"}),(0,i.jsx)(o.z,{as:"a",href:"/patient/video",className:"mt-2 px-8",variant:o.W.secondary,outline:!0,children:"Leave Waiting Room"})]})})]})};p.Layout=h.ZP;var g=p},602:function(e,t,n){"use strict";n.d(t,{G:function(){return r}});var i={backendRoot:"http://localhost:3000",token:{get:"/visit/token",validate:"/token/validate"},visits:{list:"/visits",get:"/visits/{id}",patientRoomToken:"/visit/room"},get:function(e){return"".concat(i.backendRoot).concat(e)}};var r={checkRoom:function(e,t){return fetch(i.get(i.visits.patientRoomToken),{method:"POST",body:JSON.stringify({room_name:t}),headers:{authorization:"Bearer ".concat(e.token),Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){return e}))}}},1163:function(e,t,n){e.exports=n(387)}},function(e){e.O(0,[74,275,117,774,888,179],(function(){return t=6281,e(e.s=t);var t}));var t=e.O();_N_E=t}]);