(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[665],{62616:function(n,t,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/patient/video",function(){return e(47712)}])},61783:function(n,t,e){"use strict";e.d(t,{N:function(){return c},O:function(){return a}});var o=e(85893),r=e(67294),i=e(34929),c=(0,r.createContext)(null),a=function(n){var t=n.children,e=(0,r.useState)(""),a=e[0],u=e[1],s=(0,r.useState)(null),f=s[0],d=s[1],l=(0,r.useState)(null),h=l[0],v=l[1],p=(0,r.useCallback)((function(n){try{var t=new i.SyncClient(n);window.syncClient=t,u(n),d(t)}catch(e){throw new Error(e)}}),[]);return(0,r.useEffect)((function(){f&&f.stream("OnDemandStream").then((function(n){v(n)}))}),[f]),(0,o.jsx)(c.Provider,{value:{syncToken:a,connect:p,syncClient:f,onDemandStream:h},children:t})}},855:function(n,t,e){"use strict";e.d(t,{Z:function(){return a}});var o=e(67294),r=e(48847),i=e(1438),c=e(34155);function a(){var n,t=(0,o.useState)(i.DF),e=t[0],a=(t[1],{bandwidthProfile:{video:{mode:e.bandwidthProfileMode,dominantSpeakerPriority:e.dominantSpeakerPriority,trackSwitchOffMode:e.trackSwitchOffMode,contentPreferencesMode:e.contentPreferencesMode,clientTrackSwitchOffControl:e.clientTrackSwitchOffControl}},dominantSpeaker:!0,networkQuality:{local:1,remote:1},maxAudioBitrate:Number(e.maxAudioBitrate),preferredVideoCodecs:[{codec:"VP8",simulcast:"peer-to-peer"!==e.roomType&&"go"!==e.roomType}],environment:c.env.REACT_APP_TWILIO_ENVIRONMENT});return r.tq&&(null===a||void 0===a||null===(n=a.bandwidthProfile)||void 0===n?void 0:n.video)&&(a.bandwidthProfile.video.maxSubscriptionBitrate=25e5),"dev"===c.env.REACT_APP_TWILIO_ENVIRONMENT&&(a.wsServer="wss://us2.vss.dev.twilio.com/signaling"),(0,r.po)(a)}},30708:function(n,t,e){"use strict";var o=e(85893);t.Z=function(){for(var n=arguments.length,t=new Array(n),e=0;e<n;e++)t[e]=arguments[e];return function(n){var e=n.children;return t.reduceRight((function(n,t){return(0,o.jsx)(t,{children:n})}),e)}}},69623:function(n,t,e){"use strict";var o=e(85893),r=e(11163),i=e(67294),c=e(51582),a=e(8225),u=e(61783),s=e(50784),f=e(855),d=e(15428),l=(0,e(30708).Z)((function(n){var t=(0,c.R)(),e=t.visit,a=t.user,u=(0,d.Z)(),s=u.getAudioAndVideoTracks,f=u.localTracks,l=(0,i.useState)(),h=l[0],v=l[1];return(0,i.useEffect)((function(){h||s().catch((function(n){console.log("Error acquiring local media:"),console.dir(n),v(n),r.default.push("/patient/video/no-av-permission")}))}),[s,h]),e&&a&&f&&f.length>1&&(0,o.jsx)(o.Fragment,{children:n.children})}),a.a,u.O);t.Z=function(n){var t=(0,f.Z)();return(0,o.jsx)(c.KX,{children:(0,o.jsx)(s.Z,{options:t,onError:function(n){return console.log(n)},children:(0,o.jsx)(l,{children:n.children})})})}},47712:function(n,t,e){"use strict";e.r(t);var o=e(85893),r=e(67294),i=e(15428),c=e(75270),a=e(51582),u=e(36539),s=e(11163),f=e(69623),d=e(610),l=function(){var n=(0,a.R)(),t=n.user,e=n.visit,f=(0,i.Z)(),l=f.connect,h=f.room,v=(0,d.Z)().connect,p=(0,s.useRouter)();return(0,r.useEffect)((function(){h||u.G.checkRoom(t,e.roomName).then((function(n){n.roomAvailable||p.push("/patient/waiting-room");var t=n.token;v(t),l(t)}))}),[p,h]),(0,o.jsx)(c.ls,{})};l.Layout=f.Z,t.default=l},36539:function(n,t,e){"use strict";e.d(t,{G:function(){return s}});var o=e(35666),r=e.n(o),i=e(43820);function c(n,t,e,o,r,i,c){try{var a=n[i](c),u=a.value}catch(s){return void e(s)}a.done?t(u):Promise.resolve(u).then(o,r)}function a(n){return function(){var t=this,e=arguments;return new Promise((function(o,r){var i=n.apply(t,e);function a(n){c(i,o,r,a,u,"next",n)}function u(n){c(i,o,r,a,u,"throw",n)}a(void 0)}))}}function u(){return(u=a(r().mark((function n(t,e,o){return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch(i.X.get(i.X.visits.recording),{method:"POST",body:JSON.stringify({room_sid:e,action:o}),headers:{authorization:"Bearer ".concat(t.token),Accept:"application/json","Content-Type":"application/json"}}).then((function(n){return n.json()}));case 2:case"end":return n.stop()}}),n)})))).apply(this,arguments)}var s={checkRoom:function(n,t){return fetch(i.X.get(i.X.visits.patientRoomToken),{method:"POST",body:JSON.stringify({room_name:t}),headers:{authorization:"Bearer ".concat(n.token),Accept:"application/json","Content-Type":"application/json"}}).then((function(n){return n.json()})).then((function(n){return n}))},createRoom:function(n,t){return fetch(i.X.get(i.X.visits.providerRoomToken),{method:"POST",body:JSON.stringify({room_name:t}),headers:{authorization:"Bearer ".concat(n.token),Accept:"application/json","Content-Type":"application/json"}}).then((function(n){return n.json()})).then((function(n){return n}))},toggleRecording:function(n,t,e){return u.apply(this,arguments)}}}},function(n){n.O(0,[816,221,389,313,283,337,270,774,888,179],(function(){return t=62616,n(n.s=t);var t}));var t=n.O();_N_E=t}]);