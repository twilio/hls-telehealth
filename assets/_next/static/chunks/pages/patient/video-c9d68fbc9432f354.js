(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[665],{62616:function(n,t,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/patient/video",function(){return e(47712)}])},855:function(n,t,e){"use strict";e.d(t,{Z:function(){return a}});var o=e(67294),r=e(48847),i=e(1438),c=e(34155);function a(){var n,t=(0,o.useState)(i.DF),e=t[0],a=(t[1],{bandwidthProfile:{video:{mode:e.bandwidthProfileMode,dominantSpeakerPriority:e.dominantSpeakerPriority,trackSwitchOffMode:e.trackSwitchOffMode,contentPreferencesMode:e.contentPreferencesMode,clientTrackSwitchOffControl:e.clientTrackSwitchOffControl}},dominantSpeaker:!0,networkQuality:{local:1,remote:1},maxAudioBitrate:Number(e.maxAudioBitrate),preferredVideoCodecs:[{codec:"VP8",simulcast:"peer-to-peer"!==e.roomType&&"go"!==e.roomType}],environment:c.env.REACT_APP_TWILIO_ENVIRONMENT});return r.tq&&(null===a||void 0===a||null===(n=a.bandwidthProfile)||void 0===n?void 0:n.video)&&(a.bandwidthProfile.video.maxSubscriptionBitrate=25e5),"dev"===c.env.REACT_APP_TWILIO_ENVIRONMENT&&(a.wsServer="wss://us2.vss.dev.twilio.com/signaling"),(0,r.po)(a)}},69623:function(n,t,e){"use strict";var o=e(85893),r=e(67294),i=e(51582),c=e(8225),a=e(50784),u=e(855),s=e(15428);function d(n){var t=(0,i.R)(),e=t.visit,c=t.user,a=(0,s.Z)(),u=a.getAudioAndVideoTracks,d=a.localTracks,f=(0,r.useState)(),l=f[0],h=f[1];return(0,r.useEffect)((function(){l||u().catch((function(n){console.log("Error acquiring local media:"),console.dir(n),h(n)}))}),[u,l]),e&&c&&d&&d.length>0&&(0,o.jsx)(o.Fragment,{children:n.children})}t.Z=function(n){var t=(0,u.Z)();return(0,o.jsx)(i.KX,{children:(0,o.jsx)(a.Z,{options:t,onError:function(n){return console.log(n)},children:(0,o.jsx)(d,{children:(0,o.jsx)(c.a,{children:n.children})})})})}},47712:function(n,t,e){"use strict";e.r(t);var o=e(85893),r=e(67294),i=e(15428),c=e(55010),a=e(51582),u=e(36539),s=e(11163),d=e(69623),f=e(610),l=function(){var n=(0,a.R)(),t=n.user,e=n.visit,d=(0,i.Z)(),l=d.connect,h=d.room,p=(0,f.Z)().connect,v=(0,s.useRouter)();return(0,r.useEffect)((function(){h||u.G.checkRoom(t,e.roomName).then((function(n){n.roomAvailable||v.push("/patient/waiting-room"),p(n.token),l(n.token)}))}),[v,h]),(0,o.jsx)(c.ls,{})};l.Layout=d.Z,t.default=l},36539:function(n,t,e){"use strict";e.d(t,{G:function(){return s}});var o=e(35666),r=e.n(o),i=e(43820);function c(n,t,e,o,r,i,c){try{var a=n[i](c),u=a.value}catch(s){return void e(s)}a.done?t(u):Promise.resolve(u).then(o,r)}function a(n){return function(){var t=this,e=arguments;return new Promise((function(o,r){var i=n.apply(t,e);function a(n){c(i,o,r,a,u,"next",n)}function u(n){c(i,o,r,a,u,"throw",n)}a(void 0)}))}}function u(){return(u=a(r().mark((function n(t,e,o){return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch(i.X.get(i.X.visits.recording),{method:"POST",body:JSON.stringify({room_sid:e,action:o}),headers:{authorization:"Bearer ".concat(t.token),Accept:"application/json","Content-Type":"application/json"}}).then((function(n){return n.json()}));case 2:case"end":return n.stop()}}),n)})))).apply(this,arguments)}var s={checkRoom:function(n,t){return fetch(i.X.get(i.X.visits.patientRoomToken),{method:"POST",body:JSON.stringify({room_name:t}),headers:{authorization:"Bearer ".concat(n.token),Accept:"application/json","Content-Type":"application/json"}}).then((function(n){return n.json()})).then((function(n){return n}))},createRoom:function(n,t){return fetch(i.X.get(i.X.visits.providerRoomToken),{method:"POST",body:JSON.stringify({room_name:t}),headers:{authorization:"Bearer ".concat(n.token),Accept:"application/json","Content-Type":"application/json"}}).then((function(n){return n.json()})).then((function(n){return n}))},toggleRecording:function(n,t,e){return u.apply(this,arguments)}}},11163:function(n,t,e){n.exports=e(90387)}},function(n){n.O(0,[816,221,946,283,421,10,774,888,179],(function(){return t=62616,n(n.s=t);var t}));var t=n.O();_N_E=t}]);