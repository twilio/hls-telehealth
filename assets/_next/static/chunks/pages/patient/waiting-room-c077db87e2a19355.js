(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[515],{26281:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/patient/waiting-room",function(){return n(28112)}])},855:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var i=n(67294),r=n(48847),o=n(1438),c=n(34155);function a(){var e,t=(0,i.useState)(o.DF),n=t[0],a=(t[1],{bandwidthProfile:{video:{mode:n.bandwidthProfileMode,dominantSpeakerPriority:n.dominantSpeakerPriority,trackSwitchOffMode:n.trackSwitchOffMode,contentPreferencesMode:n.contentPreferencesMode,clientTrackSwitchOffControl:n.clientTrackSwitchOffControl}},dominantSpeaker:!0,networkQuality:{local:1,remote:1},maxAudioBitrate:Number(n.maxAudioBitrate),preferredVideoCodecs:[{codec:"VP8",simulcast:"peer-to-peer"!==n.roomType&&"go"!==n.roomType}],environment:c.env.REACT_APP_TWILIO_ENVIRONMENT});return r.tq&&(null===a||void 0===a||null===(e=a.bandwidthProfile)||void 0===e?void 0:e.video)&&(a.bandwidthProfile.video.maxSubscriptionBitrate=25e5),"dev"===c.env.REACT_APP_TWILIO_ENVIRONMENT&&(a.wsServer="wss://us2.vss.dev.twilio.com/signaling"),(0,r.po)(a)}},69623:function(e,t,n){"use strict";var i=n(85893),r=n(67294),o=n(51582),c=n(8225),a=n(95133),s=n(855),l=n(15428);function u(e){var t=(0,o.R)(),n=t.visit,c=t.user,a=(0,l.Z)(),s=a.getAudioAndVideoTracks,u=a.localTracks,d=(0,r.useState)(),f=d[0],m=d[1];return(0,r.useEffect)((function(){f||s().catch((function(e){console.log("Error acquiring local media:"),console.dir(e),m(e)}))}),[s,f]),n&&c&&u&&u.length>0&&(0,i.jsx)(i.Fragment,{children:e.children})}t.Z=function(e){var t=(0,s.Z)();return(0,i.jsx)(o.KX,{children:(0,i.jsx)(a.Z,{options:t,onError:function(e){return console.log(e)},children:(0,i.jsx)(u,{children:(0,i.jsx)(c.a,{children:e.children})})})})}},73870:function(e,t,n){"use strict";n.d(t,{c:function(){return v}});var i=n(85893),r=n(67294),o=n(53352),c=n(15428),a=n(97811),s=n(56419),l=n(5909),u=n(1438),d=n(45067);function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m=function(e){var t=e.containerClass,n=(0,c.Z)().localTracks,o=n.find((function(e){return"audio"===e.kind})),a=n.find((function(e){return"video"===e.kind})),m=(0,l.Z)(a),v=(0,r.useState)(!1),h=v[0],x=v[1],p=(0,r.useState)(!1),j=p[0],g=p[1],y=(0,r.useState)(!1),k=y[0],b=y[1],N=(0,d.Z)().videoInputDevices,w=(0,r.useCallback)((function(){var e="user"===(null===m||void 0===m?void 0:m.getSettings().facingMode)?"environment":"user";null===a||void 0===a||a.restart(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){f(e,t,n[t])}))}return e}({},u.lA,{facingMode:e}))}),[m,a]);return(0,r.useEffect)((function(){(null===m||void 0===m?void 0:m.getSettings().facingMode)&&!1===k&&b(!0)}),[m,k]),(0,r.useEffect)((function(){a&&(j?a.disable():a.enable())}),[j]),(0,r.useEffect)((function(){o&&(h?o.disable():o.enable())}),[h]),(0,i.jsxs)("div",{className:t,children:[k&&N.length>1&&(0,i.jsx)(s.z,{className:"my-2",icon:"flip_camera_ios",iconType:"outline",variant:s.W.tertiary,onClick:w}),(0,i.jsx)(s.z,{className:"my-2",icon:j?"videocam_off":"videocam",iconType:"outline",variant:s.W.tertiary,onClick:function(){return g(!j)}}),(0,i.jsx)(s.z,{className:"my-2",icon:h?"mic_off":"mic",iconType:"outline",variant:s.W.tertiary,onClick:function(){return x(!h)}})]})},v=function(e){var t=e.videoImage,n=(0,c.Z)().localTracks,r=n.find((function(e){return"audio"===e.kind})),s=n.find((function(e){return"video"===e.kind}));return(0,i.jsxs)("div",{className:"flex mt-4 mb-1",children:[(0,i.jsx)(m,{containerClass:"flex flex-col justify-center px-1"}),(0,i.jsx)("div",{className:"flex-grow px-1",children:s?(0,i.jsx)(o.Z,{track:s,isLocal:!0}):(0,i.jsx)("img",{src:t,alt:"Video",width:187,height:250})}),r&&(0,i.jsx)(a.Z,{track:r})]})}},28112:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return y}});var i=n(85893),r=n(67294),o=n(56419),c=n(39716),a=n(99490),s=function(e){var t=e.name;return(0,i.jsx)(c.J,{className:"mr-2 text-tertiary",name:t})},l=function(e){var t=e.date,n=a.ou.fromISO(t);return(0,i.jsxs)("div",{className:"flex w-3/4 border border-light rounded-lg text-secondary",children:[(0,i.jsxs)("div",{className:"flex p-2 border-r border-light",children:[(0,i.jsx)(s,{name:"calendar_today"})," ",n.toFormat("DD")]}),(0,i.jsxs)("div",{className:"flex p-2",children:[(0,i.jsx)(s,{name:"schedule"})," ",n.toFormat("t")]})]})},u=n(9783),d=n(41117),f=n(39891),m=n(73870),v=n(51582),h=n(15428),x=n(36539),p=n(11163),j=n(69623),g=function(){var e=(0,r.useState)(!1),t=e[0],n=e[1],c=(0,v.R)(),a=c.visit,s=c.user,j=(0,h.Z)().getAudioAndVideoTracks,g=(0,r.useState)(),y=g[0],k=g[1],b=(0,p.useRouter)();return(0,r.useEffect)((function(){y||j().catch((function(e){console.log("Error acquiring local media:"),console.dir(e),k(e)}))}),[j,y]),(0,r.useEffect)((function(){if(s&&a){var e=setInterval((function(){return x.G.checkRoom(s,a.roomName).then((function(e){e.roomAvailable&&b.push("/patient/video/")}))}),5e3);return function(){return clearInterval(e)}}}),[b,a,s]),(0,i.jsxs)(d.Ar,{children:[a?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(u.X,{children:"Your Appointment"}),(0,i.jsxs)("div",{className:"mb-2 text-secondary flex flex-col items-center",children:[(0,i.jsx)("p",{children:a.providerName}),(0,i.jsx)(l,{date:a.visitDateTime.toString()})]}),(0,i.jsxs)("div",{className:"my-4 px-10 md:px-2 lg:px-2 xl:px-2 flex flex-col items-center justify-center",children:[(0,i.jsx)(m.c,{videoImage:"/patient.jpg"}),(0,i.jsx)("div",{className:"text-tertiary",children:"Your visit will start when the provider joins"}),(0,i.jsx)("div",{className:"flex items-center justify-center bg-secondary text-white text-2xl h-[150px] w-full m-2",children:"Content Area"}),(0,i.jsx)(o.z,{className:"mt-2 px-8",variant:o.W.secondary,outline:!0,onClick:function(){return n(!0)},children:"Leave Waiting Room"})]})]}):(0,i.jsx)(i.Fragment,{}),(0,i.jsx)(f.u,{isVisible:t,children:(0,i.jsxs)("div",{className:"flex flex-col text-center p-4",children:[(0,i.jsx)("p",{className:"mb-4 text-primary",children:"Are you sure you want to leave the waiting room? Your visit will start shortly."}),(0,i.jsx)(o.z,{className:"mt-2 px-8",onClick:function(){return n(!1)},children:"Stay in Waiting Room"}),(0,i.jsx)(o.z,{as:"a",href:"/patient/video",className:"mt-2 px-8",variant:o.W.secondary,outline:!0,children:"Leave Waiting Room"})]})})]})};g.Layout=j.Z;var y=g},43820:function(e,t,n){"use strict";n.d(t,{X:function(){return i}});var i={backendRoot:"http://localhost:3001",token:{get:"/visit/token",validate:"/token/validate"},visits:{list:"/visits",get:"/visits/{id}",token:"/visit/token",patientRoomToken:"/visit/room",providerRoomToken:"/visit/provider-room"},get:function(e){return"".concat(i.backendRoot).concat(e)}}},36539:function(e,t,n){"use strict";n.d(t,{G:function(){return r}});var i=n(43820);var r={checkRoom:function(e,t){return fetch(i.X.get(i.X.visits.patientRoomToken),{method:"POST",body:JSON.stringify({room_name:t}),headers:{authorization:"Bearer ".concat(e.token),Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){return e}))},createRoom:function(e,t){return fetch(i.X.get(i.X.visits.providerRoomToken),{method:"POST",body:JSON.stringify({room_name:t}),headers:{authorization:"Bearer ".concat(e.token),Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){return e}))}}},11163:function(e,t,n){e.exports=n(90387)}},function(e){e.O(0,[816,221,809,946,283,274,117,774,888,179],(function(){return t=26281,e(e.s=t);var t}));var t=e.O();_N_E=t}]);