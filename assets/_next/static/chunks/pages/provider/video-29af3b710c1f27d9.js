(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[994],{4234:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/provider/video",function(){return n(37)}])},855:function(t,e,n){"use strict";n.d(e,{Z:function(){return u}});var o=n(7294),r=n(8847),i=n(1438),c=n(4155);function u(){var t,e=(0,o.useState)(i.DF),n=e[0],u=(e[1],{bandwidthProfile:{video:{mode:n.bandwidthProfileMode,dominantSpeakerPriority:n.dominantSpeakerPriority,trackSwitchOffMode:n.trackSwitchOffMode,contentPreferencesMode:n.contentPreferencesMode,clientTrackSwitchOffControl:n.clientTrackSwitchOffControl}},dominantSpeaker:!0,networkQuality:{local:1,remote:1},maxAudioBitrate:Number(n.maxAudioBitrate),preferredVideoCodecs:[{codec:"VP8",simulcast:"peer-to-peer"!==n.roomType&&"go"!==n.roomType}],environment:c.env.REACT_APP_TWILIO_ENVIRONMENT});return r.tq&&(null===u||void 0===u||null===(t=u.bandwidthProfile)||void 0===t?void 0:t.video)&&(u.bandwidthProfile.video.maxSubscriptionBitrate=25e5),"dev"===c.env.REACT_APP_TWILIO_ENVIRONMENT&&(u.wsServer="wss://us2.vss.dev.twilio.com/signaling"),(0,r.po)(u)}},1368:function(t,e,n){"use strict";var o=n(5893),r=n(7294),i=n(5133),c=n(855),u=n(1582),a=n(5428);function s(t){var e=(0,u.R)().user,n=(0,a.Z)(),i=n.getAudioAndVideoTracks,c=n.localTracks,s=(0,r.useState)(),d=s[0],f=s[1];return(0,r.useEffect)((function(){d||i().catch((function(t){console.log("Error acquiring local media:"),console.dir(t),f(t)}))}),[i,d]),e&&c&&c.length>0&&(0,o.jsx)(o.Fragment,{children:t.children})}e.Z=function(t){var e=(0,c.Z)();return(0,o.jsx)(u.KX,{children:(0,o.jsx)(i.Z,{options:e,onError:function(t){return console.log(t)},children:(0,o.jsx)(s,{children:t.children})})})}},37:function(t,e,n){"use strict";n.r(e);var o=n(5893),r=n(7294),i=n(5428),c=n(2006),u=n(1582),a=n(1163),s=n(602),d=n(1502),f=n(1438),l=n(1368),v=function(){var t=(0,u.R)(),e=t.user,n=(t.visit,(0,i.Z)()),l=n.connect,v=n.room,h=(0,a.useRouter)();return(0,r.useEffect)((function(){v||d.Z.getFromStorage(f.bo).then((function(t){s.G.createRoom(e,t).then((function(t){t.roomAvailable||h.push("/provider/dashboard"),l(t.token)}))}))}),[h,v]),(0,o.jsx)(c.ls,{})};v.Layout=l.Z,e.default=v},602:function(t,e,n){"use strict";n.d(e,{G:function(){return r}});var o={backendRoot:"",token:{get:"/visit/token",validate:"/token/validate"},visits:{list:"/visits",get:"/visits/{id}",patientRoomToken:"/visit/room",providerRoomToken:"/visit/provider-room"},get:function(t){return"".concat(o.backendRoot).concat(t)}};var r={checkRoom:function(t,e){return fetch(o.get(o.visits.patientRoomToken),{method:"POST",body:JSON.stringify({room_name:e}),headers:{authorization:"Bearer ".concat(t.token),Accept:"application/json","Content-Type":"application/json"}}).then((function(t){return t.json()})).then((function(t){return t}))},createRoom:function(t,e){return fetch(o.get(o.visits.providerRoomToken),{method:"POST",body:JSON.stringify({room_name:e}),headers:{authorization:"Bearer ".concat(t.token),Accept:"application/json","Content-Type":"application/json"}}).then((function(t){return t.json()})).then((function(t){return t}))}}},1582:function(t,e,n){"use strict";n.d(e,{KX:function(){return s},R:function(){return d}});var o=n(5893),r=n(7294),i=n(1438),c={name:"Guest",isAuthenticated:!1,role:"guest",token:null},u=n(1502),a=(0,r.createContext)(null);function s(t){var e=(0,r.useState)(c),n=e[0],s=e[1],d=(0,r.useState)(null),f=d[0],l=d[1];return(0,r.useEffect)((function(){u.Z.getFromStorage(i.sL,c).then((function(t){if(t!==c)return s(t),u.Z.getFromStorage(i.LX)})).then((function(t){return l(t)}))}),[s,l]),(0,o.jsx)(a.Provider,{value:{user:n,visit:f,setVisit:l},children:t.children})}function d(){var t=(0,r.useContext)(a);if(!t)throw new Error("useVisitContext must be used within the VisitContextProvider");return t}}},function(t){t.O(0,[774,316,181,905,6,888,179],(function(){return e=4234,t(t.s=e);var e}));var e=t.O();_N_E=e}]);