(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[994],{24234:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/provider/video",function(){return t(40037)}])},855:function(n,e,t){"use strict";t.d(e,{Z:function(){return a}});var o=t(67294),r=t(48847),i=t(1438),c=t(34155);function a(){var n,e=(0,o.useState)(i.DF),t=e[0],a=(e[1],{bandwidthProfile:{video:{mode:t.bandwidthProfileMode,dominantSpeakerPriority:t.dominantSpeakerPriority,trackSwitchOffMode:t.trackSwitchOffMode,contentPreferencesMode:t.contentPreferencesMode,clientTrackSwitchOffControl:t.clientTrackSwitchOffControl}},dominantSpeaker:!0,networkQuality:{local:1,remote:1},maxAudioBitrate:Number(t.maxAudioBitrate),preferredVideoCodecs:[{codec:"VP8",simulcast:"peer-to-peer"!==t.roomType&&"go"!==t.roomType}],environment:c.env.REACT_APP_TWILIO_ENVIRONMENT});return r.tq&&(null===a||void 0===a||null===(n=a.bandwidthProfile)||void 0===n?void 0:n.video)&&(a.bandwidthProfile.video.maxSubscriptionBitrate=25e5),"dev"===c.env.REACT_APP_TWILIO_ENVIRONMENT&&(a.wsServer="wss://us2.vss.dev.twilio.com/signaling"),(0,r.po)(a)}},31368:function(n,e,t){"use strict";var o=t(85893),r=t(67294),i=t(95133),c=t(855),a=t(51582),u=t(15428),s=t(8225);function d(n){var e=(0,a.R)().user,t=(0,u.Z)(),i=t.getAudioAndVideoTracks,c=t.localTracks,s=(0,r.useState)(),d=s[0],f=s[1];return(0,r.useEffect)((function(){d||i().catch((function(n){console.log("Error acquiring local media:"),console.dir(n),f(n)}))}),[i,d]),e&&c&&c.length>0&&(0,o.jsx)(o.Fragment,{children:n.children})}e.Z=function(n){var e=(0,c.Z)();return(0,o.jsx)(a.KX,{children:(0,o.jsx)(i.Z,{options:e,onError:function(n){return console.log(n)},children:(0,o.jsx)(d,{children:(0,o.jsx)(s.a,{children:n.children})})})})}},40037:function(n,e,t){"use strict";t.r(e);var o=t(35666),r=t.n(o),i=t(85893),c=t(67294),a=t(15428),u=t(72006),s=t(51582),d=t(11163),f=t(36539),v=t(51502),l=t(1438),h=t(31368),p=t(610);function m(n,e,t,o,r,i,c){try{var a=n[i](c),u=a.value}catch(s){return void t(s)}a.done?e(u):Promise.resolve(u).then(o,r)}var k=function(){var n=(0,s.R)(),e=n.user,t=(n.visit,(0,a.Z)()),o=t.connect,h=t.room,k=(0,p.Z)().connect,w=(0,d.useRouter)();return(0,c.useEffect)((function(){h||v.Z.getFromStorage(l.bo).then((function(n){var t;f.G.createRoom(e,n).then((t=r().mark((function n(e){return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.roomAvailable||w.push("/provider/dashboard"),n.next=3,o(e.token);case 3:k(e.token);case 4:case"end":return n.stop()}}),n)})),function(){var n=this,e=arguments;return new Promise((function(o,r){var i=t.apply(n,e);function c(n){m(i,o,r,c,a,"next",n)}function a(n){m(i,o,r,c,a,"throw",n)}c(void 0)}))}))}))}),[w,h]),(0,i.jsx)(u.ls,{})};k.Layout=h.Z,e.default=k},43820:function(n,e,t){"use strict";t.d(e,{X:function(){return o}});var o={backendRoot:"http://localhost:3001",token:{get:"/visit/token",validate:"/token/validate"},visits:{list:"/visits",get:"/visits/{id}",token:"/visit/token",patientRoomToken:"/visit/room",providerRoomToken:"/visit/provider-room"},get:function(n){return"".concat(o.backendRoot).concat(n)}}},36539:function(n,e,t){"use strict";t.d(e,{G:function(){return r}});var o=t(43820);var r={checkRoom:function(n,e){return fetch(o.X.get(o.X.visits.patientRoomToken),{method:"POST",body:JSON.stringify({room_name:e}),headers:{authorization:"Bearer ".concat(n.token),Accept:"application/json","Content-Type":"application/json"}}).then((function(n){return n.json()})).then((function(n){return n}))},createRoom:function(n,e){return fetch(o.X.get(o.X.visits.providerRoomToken),{method:"POST",body:JSON.stringify({room_name:e}),headers:{authorization:"Bearer ".concat(n.token),Accept:"application/json","Content-Type":"application/json"}}).then((function(n){return n.json()})).then((function(n){return n}))}}}},function(n){n.O(0,[774,816,221,946,181,274,6,888,179],(function(){return e=24234,n(n.s=e);var e}));var e=n.O();_N_E=e}]);